import{r as c,j as t,e as R,f as x,h as B,i as P}from"./index-p9LGmgRI.js";import{F as Q,a as m,e as T,b as y,c as f,d as A}from"./index-BdB8jTt3.js";const $="_dashboard_4hifh_3",F="_header_4hifh_17",k="_controls_4hifh_59",E="_dateSelector_4hifh_73",M="_icon_4hifh_93",U="_dateInput_4hifh_103",G="_subjectSelector_4hifh_131",L="_subjectDropdown_4hifh_141",O="_content_4hifh_191",z="_leftPanel_4hifh_203",H="_rightPanel_4hifh_219",J="_qrSection_4hifh_257",K="_stats_4hifh_257",V="_qrContainer_4hifh_307",W="_qrImage_4hifh_341",X="_qrPlaceholder_4hifh_353",Y="_generateButton_4hifh_373",Z="_statCards_4hifh_421",tt="_statCard_4hifh_421",et="_statIcon_4hifh_469",st="_present_4hifh_493",at="_absent_4hifh_503",nt="_total_4hifh_513",ct="_statInfo_4hifh_523",lt="_attendanceTable_4hifh_551",ot="_status_4hifh_629",dt="_noData_4hifh_675",rt="_qrButtons_4hifh_811",it="_deactivateButton_4hifh_863",e={dashboard:$,header:F,controls:k,dateSelector:E,icon:M,dateInput:U,subjectSelector:G,subjectDropdown:L,content:O,leftPanel:z,rightPanel:H,qrSection:J,stats:K,qrContainer:V,qrImage:W,qrPlaceholder:X,generateButton:Y,statCards:Z,statCard:tt,statIcon:et,present:st,absent:at,total:nt,statInfo:ct,attendanceTable:lt,status:ot,noData:dt,qrButtons:rt,deactivateButton:it},_t=()=>{const b=new Date().toISOString().split("T")[0],[o,p]=c.useState(b),[d,i]=c.useState(null),[S,h]=c.useState([]),[g,v]=c.useState([]),[n,j]=c.useState("");c.useEffect(()=>{async function s(){const a=await R();v(a.data.user.subjects),j(a.data.user.subjects[0]||"");const r=await x(a.data.user.subjects[0]);h(r.data.classData||[])}s()},[]);const l=S?.filter(s=>{const r=new Date(s.date).toISOString().split("T")[0]===o,w=n==="all"||s.subject===n;return r&&w}),_=l.filter(s=>s.status==="present").length,N=l.filter(s=>s.status==="absent").length,u=l.length,C=u>0?Math.round(_/u*100):0,D=async()=>{const s=await B(n);s.status===201?i(s.data.qrImage):(console.log(s.message),alert("QR code did not generate"))},I=async()=>{(await P(n)).status===200&&(i(null),alert("QR code deactivate sucessfully"),window.location.reload())},q=async s=>{j(s.target.value);const a=await x(s.target.value);console.log(a.data.classData),h(a.data.classData||[])};return t.jsxs("div",{className:e.dashboard,children:[t.jsxs("header",{className:e.header,children:[t.jsx("h1",{children:"Teacher Dashboard"}),t.jsxs("div",{className:e.controls,children:[t.jsxs("div",{className:e.dateSelector,children:[t.jsx(Q,{className:e.icon}),t.jsx("input",{type:"date",value:o,onChange:s=>p(s.target.value),className:e.dateInput})]}),t.jsx("div",{className:e.subjectSelector,children:t.jsx("select",{value:n,onChange:q,className:e.subjectDropdown,children:g.map((s,a)=>t.jsx("option",{value:s,children:s==="all"?"All Subjects":s},a))})})]})]}),t.jsxs("div",{className:e.content,children:[t.jsxs("div",{className:e.leftPanel,children:[t.jsxs("div",{className:e.qrSection,children:[t.jsxs("h2",{children:[t.jsx(m,{className:e.icon})," Attendance QR Code"]}),t.jsx("div",{className:e.qrContainer,children:d?t.jsx("img",{src:d,alt:"Attendance QR Code",className:e.qrImage}):t.jsxs("div",{className:e.qrPlaceholder,children:[t.jsx(m,{size:50}),t.jsx("p",{children:"Generate a QR code for students to scan"})]})}),t.jsxs("div",{className:e.qrButtons,children:[t.jsx("button",{onClick:D,className:e.generateButton,children:"Generate QR Code"}),d&&t.jsxs("button",{onClick:I,className:e.deactivateButton,children:[t.jsx(T,{})," Deactivate QR"]})]})]}),t.jsxs("div",{className:e.stats,children:[t.jsxs("h2",{children:[t.jsx(y,{className:e.icon})," Attendance Summary"]}),t.jsxs("div",{className:e.statCards,children:[t.jsxs("div",{className:e.statCard,children:[t.jsx("div",{className:`${e.statIcon} ${e.present}`,children:t.jsx(f,{})}),t.jsxs("div",{className:e.statInfo,children:[t.jsx("h3",{children:_}),t.jsx("p",{children:"Present"})]})]}),t.jsxs("div",{className:e.statCard,children:[t.jsx("div",{className:`${e.statIcon} ${e.absent}`,children:t.jsx(A,{})}),t.jsxs("div",{className:e.statInfo,children:[t.jsx("h3",{children:N}),t.jsx("p",{children:"Absent"})]})]}),t.jsxs("div",{className:e.statCard,children:[t.jsx("div",{className:`${e.statIcon} ${e.total}`,children:t.jsx(f,{})}),t.jsxs("div",{className:e.statInfo,children:[t.jsxs("h3",{children:[C,"%"]}),t.jsx("p",{children:"Attendance Rate"})]})]})]})]})]}),t.jsxs("div",{className:e.rightPanel,children:[t.jsxs("h2",{children:["Attendance Records for ",new Date(o).toLocaleDateString()]}),n!=="all"&&t.jsxs("p",{children:["Subject: ",n]}),t.jsx("div",{className:e.attendanceTable,children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Student ID"}),t.jsx("th",{children:"Name"}),t.jsx("th",{children:"Subject"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Time"})]})}),t.jsx("tbody",{children:l.length>0?l.map(s=>t.jsxs("tr",{children:[t.jsx("td",{children:s.studentId}),t.jsx("td",{children:s.name}),t.jsx("td",{children:s.subject}),t.jsx("td",{children:t.jsx("span",{className:`${e.status} ${e[s.status]}`,children:s.status})}),t.jsx("td",{children:new Date(s.date).toLocaleTimeString()})]},s._id)):t.jsx("tr",{children:t.jsx("td",{colSpan:"5",className:e.noData,children:"No attendance records for this date"})})})]})})]})]})]})};export{_t as default};

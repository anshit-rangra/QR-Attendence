import{r as l,j as t,L as P,e as Q,f,h as T,i as y}from"./index-tHXuMdQR.js";import{F as A,a as m,e as $,b as F,c as b,d as L}from"./index-CU7PDXD_.js";const k="_dashboard_4hifh_3",E="_header_4hifh_17",M="_controls_4hifh_59",U="_dateSelector_4hifh_73",G="_icon_4hifh_93",O="_dateInput_4hifh_103",z="_subjectSelector_4hifh_131",H="_subjectDropdown_4hifh_141",J="_content_4hifh_191",K="_leftPanel_4hifh_203",V="_rightPanel_4hifh_219",W="_qrSection_4hifh_257",X="_stats_4hifh_257",Y="_qrContainer_4hifh_307",Z="_qrImage_4hifh_341",tt="_qrPlaceholder_4hifh_353",et="_generateButton_4hifh_373",st="_statCards_4hifh_421",at="_statCard_4hifh_421",nt="_statIcon_4hifh_469",ct="_present_4hifh_493",lt="_absent_4hifh_503",ot="_total_4hifh_513",rt="_statInfo_4hifh_523",dt="_attendanceTable_4hifh_551",it="_status_4hifh_629",ht="_noData_4hifh_675",jt="_qrButtons_4hifh_811",ut="_deactivateButton_4hifh_863",e={dashboard:k,header:E,controls:M,dateSelector:U,icon:G,dateInput:O,subjectSelector:z,subjectDropdown:H,content:J,leftPanel:K,rightPanel:V,qrSection:W,stats:X,qrContainer:Y,qrImage:Z,qrPlaceholder:tt,generateButton:et,statCards:st,statCard:at,statIcon:nt,present:ct,absent:lt,total:ot,statInfo:rt,attendanceTable:dt,status:it,noData:ht,qrButtons:jt,deactivateButton:ut},ft=()=>{const g=new Date().toISOString().split("T")[0],[r,S]=l.useState(g),[d,h]=l.useState(null),[p,j]=l.useState([]),[v,N]=l.useState([]),[c,u]=l.useState(""),[C,n]=l.useState(!1);l.useEffect(()=>{async function s(){n(!0);const a=await Q();N(a.data.user.subjects),u(a.data.user.subjects[0]||"");const i=await f(a.data.user.subjects[0]);j(i.data.classData||[]),n(!1)}s()},[]);const o=p?.filter(s=>{const i=new Date(s.date).toISOString().split("T")[0]===r,B=c==="all"||s.subject===c;return i&&B}),_=o.filter(s=>s.status==="present").length,D=o.filter(s=>s.status==="absent").length,x=o.length,I=x>0?Math.round(_/x*100):0,q=async()=>{n(!0);const s=await T(c);n(!1),s.status===201?h(s.data.qrImage):(console.log(s.message),alert("QR code did not generate"))},w=async()=>{n(!0);const s=await y(c);n(!1),s.status===200&&(h(null),alert("QR code deactivate sucessfully"),window.location.reload())},R=async s=>{u(s.target.value),n(!0);const a=await f(s.target.value);n(!1),console.log(a.data.classData),j(a.data.classData||[])};return C?t.jsx(P,{}):t.jsxs("div",{className:e.dashboard,children:[t.jsxs("header",{className:e.header,children:[t.jsx("h1",{children:"Teacher Dashboard"}),t.jsxs("div",{className:e.controls,children:[t.jsxs("div",{className:e.dateSelector,children:[t.jsx(A,{className:e.icon}),t.jsx("input",{type:"date",value:r,onChange:s=>S(s.target.value),className:e.dateInput})]}),t.jsx("div",{className:e.subjectSelector,children:t.jsx("select",{value:c,onChange:R,className:e.subjectDropdown,children:v.map((s,a)=>t.jsx("option",{value:s,children:s==="all"?"All Subjects":s},a))})})]})]}),t.jsxs("div",{className:e.content,children:[t.jsxs("div",{className:e.leftPanel,children:[t.jsxs("div",{className:e.qrSection,children:[t.jsxs("h2",{children:[t.jsx(m,{className:e.icon})," Attendance QR Code"]}),t.jsx("div",{className:e.qrContainer,children:d?t.jsx("img",{src:d,alt:"Attendance QR Code",className:e.qrImage}):t.jsxs("div",{className:e.qrPlaceholder,children:[t.jsx(m,{size:50}),t.jsx("p",{children:"Generate a QR code for students to scan"})]})}),t.jsxs("div",{className:e.qrButtons,children:[t.jsx("button",{onClick:q,className:e.generateButton,children:"Generate QR Code"}),d&&t.jsxs("button",{onClick:w,className:e.deactivateButton,children:[t.jsx($,{})," Deactivate QR"]})]})]}),t.jsxs("div",{className:e.stats,children:[t.jsxs("h2",{children:[t.jsx(F,{className:e.icon})," Attendance Summary"]}),t.jsxs("div",{className:e.statCards,children:[t.jsxs("div",{className:e.statCard,children:[t.jsx("div",{className:`${e.statIcon} ${e.present}`,children:t.jsx(b,{})}),t.jsxs("div",{className:e.statInfo,children:[t.jsx("h3",{children:_}),t.jsx("p",{children:"Present"})]})]}),t.jsxs("div",{className:e.statCard,children:[t.jsx("div",{className:`${e.statIcon} ${e.absent}`,children:t.jsx(L,{})}),t.jsxs("div",{className:e.statInfo,children:[t.jsx("h3",{children:D}),t.jsx("p",{children:"Absent"})]})]}),t.jsxs("div",{className:e.statCard,children:[t.jsx("div",{className:`${e.statIcon} ${e.total}`,children:t.jsx(b,{})}),t.jsxs("div",{className:e.statInfo,children:[t.jsxs("h3",{children:[I,"%"]}),t.jsx("p",{children:"Attendance Rate"})]})]})]})]})]}),t.jsxs("div",{className:e.rightPanel,children:[t.jsxs("h2",{children:["Attendance Records for ",new Date(r).toLocaleDateString()]}),c!=="all"&&t.jsxs("p",{children:["Subject: ",c]}),t.jsx("div",{className:e.attendanceTable,children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Student ID"}),t.jsx("th",{children:"Name"}),t.jsx("th",{children:"Subject"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Time"})]})}),t.jsx("tbody",{children:o.length>0?o.map(s=>t.jsxs("tr",{children:[t.jsx("td",{children:s.studentId}),t.jsx("td",{children:s.name}),t.jsx("td",{children:s.subject}),t.jsx("td",{children:t.jsx("span",{className:`${e.status} ${e[s.status]}`,children:s.status})}),t.jsx("td",{children:new Date(s.date).toLocaleTimeString()})]},s._id)):t.jsx("tr",{children:t.jsx("td",{colSpan:"5",className:e.noData,children:"No attendance records for this date"})})})]})})]})]})]})};export{ft as default};

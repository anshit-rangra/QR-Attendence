import{r as l,j as t,L as P,F as Q,a as m,f as T,b as y,d as j,e as $}from"./index-CAaY5v6k.js";import{g as A,d as b,e as F,f as L}from"./axios-Dxvmi79v.js";const k="_dashboard_4hifh_3",E="_header_4hifh_17",M="_controls_4hifh_59",U="_dateSelector_4hifh_73",G="_icon_4hifh_93",O="_dateInput_4hifh_103",z="_subjectSelector_4hifh_131",H="_subjectDropdown_4hifh_141",J="_content_4hifh_191",K="_leftPanel_4hifh_203",V="_rightPanel_4hifh_219",W="_qrSection_4hifh_257",X="_stats_4hifh_257",Y="_qrContainer_4hifh_307",Z="_qrImage_4hifh_341",tt="_qrPlaceholder_4hifh_353",st="_generateButton_4hifh_373",et="_statCards_4hifh_421",at="_statCard_4hifh_421",nt="_statIcon_4hifh_469",ct="_present_4hifh_493",lt="_absent_4hifh_503",dt="_total_4hifh_513",rt="_statInfo_4hifh_523",ot="_attendanceTable_4hifh_551",it="_status_4hifh_629",ht="_noData_4hifh_675",jt="_qrButtons_4hifh_811",ut="_deactivateButton_4hifh_863",s={dashboard:k,header:E,controls:M,dateSelector:U,icon:G,dateInput:O,subjectSelector:z,subjectDropdown:H,content:J,leftPanel:K,rightPanel:V,qrSection:W,stats:X,qrContainer:Y,qrImage:Z,qrPlaceholder:tt,generateButton:st,statCards:et,statCard:at,statIcon:nt,present:ct,absent:lt,total:dt,statInfo:rt,attendanceTable:ot,status:it,noData:ht,qrButtons:jt,deactivateButton:ut},ft=()=>{const g=new Date().toISOString().split("T")[0],[r,v]=l.useState(g),[o,u]=l.useState(null),[N,_]=l.useState([]),[S,p]=l.useState([]),[c,x]=l.useState(""),[C,n]=l.useState(!1);l.useEffect(()=>{async function e(){n(!0);const a=await A();p(a.data.user.subjects),x(a.data.user.subjects[0]||"");const h=await b(a.data.user.subjects[0]);_(h.data.classData||[]),n(!1)}e()},[]);const d=N?.filter(e=>{const h=new Date(e.date).toISOString().split("T")[0]===r,B=c==="all"||e.subject===c;return h&&B}),f=d.filter(e=>e.status==="present").length,D=d.filter(e=>e.status==="absent").length,i=d.length,I=i>0?Math.round(f/i*100):0,q=async()=>{n(!0);const e=await F(c);n(!1),e.status===201?u(e.data.qrImage):(console.log(e.message),alert("QR code did not generate"))},w=async()=>{n(!0);const e=await L(c);n(!1),e.status===200&&(u(null),alert("QR code deactivate sucessfully"),window.location.reload())},R=async e=>{x(e.target.value),n(!0);const a=await b(e.target.value);n(!1),console.log(a.data.classData),_(a.data.classData||[])};return C?t.jsx(P,{}):t.jsxs("div",{className:s.dashboard,children:[t.jsxs("header",{className:s.header,children:[t.jsx("h1",{children:"Teacher Dashboard"}),t.jsxs("div",{className:s.controls,children:[t.jsxs("div",{className:s.dateSelector,children:[t.jsx(Q,{className:s.icon}),t.jsx("input",{type:"date",value:r,onChange:e=>v(e.target.value),className:s.dateInput})]}),t.jsx("div",{className:s.subjectSelector,children:t.jsx("select",{value:c,onChange:R,className:s.subjectDropdown,children:S.map((e,a)=>t.jsx("option",{value:e,children:e==="all"?"All Subjects":e},a))})})]})]}),t.jsxs("div",{className:s.content,children:[t.jsxs("div",{className:s.leftPanel,children:[t.jsxs("div",{className:s.qrSection,children:[t.jsxs("h2",{children:[t.jsx(m,{className:s.icon})," Attendance QR Code"]}),t.jsx("div",{className:s.qrContainer,children:o?t.jsx("img",{src:o,alt:"Attendance QR Code",className:s.qrImage}):t.jsxs("div",{className:s.qrPlaceholder,children:[t.jsx(m,{size:50}),t.jsx("p",{children:"Generate a QR code for students to scan"})]})}),t.jsxs("div",{className:s.qrButtons,children:[t.jsx("button",{onClick:q,className:s.generateButton,children:"Generate QR Code"}),o&&t.jsxs("button",{onClick:w,className:s.deactivateButton,children:[t.jsx(T,{})," Deactivate QR"]})]})]}),t.jsxs("div",{className:s.stats,children:[t.jsxs("h2",{children:[t.jsx(y,{className:s.icon})," Attendance Summary"]}),t.jsxs("div",{className:s.statCards,children:[t.jsxs("div",{className:s.statCard,children:[t.jsx("div",{className:`${s.statIcon} ${s.present}`,children:t.jsx(j,{})}),t.jsxs("div",{className:s.statInfo,children:[t.jsx("h3",{children:f}),t.jsx("p",{children:"Present"})]})]}),t.jsxs("div",{className:s.statCard,children:[t.jsx("div",{className:`${s.statIcon} ${s.absent}`,children:t.jsx($,{})}),t.jsxs("div",{className:s.statInfo,children:[t.jsx("h3",{children:D}),t.jsx("p",{children:"Absent"})]})]}),t.jsxs("div",{className:s.statCard,children:[t.jsx("div",{className:`${s.statIcon} ${s.total}`,children:t.jsx(j,{})}),t.jsxs("div",{className:s.statInfo,children:[t.jsxs("h3",{children:[I,"%"]}),t.jsx("p",{children:"Attendance Rate"})]})]}),t.jsxs("div",{className:s.statCard,children:[t.jsx("div",{className:`${s.statIcon} ${s.total}`,children:t.jsx(j,{})}),t.jsxs("div",{className:s.statInfo,children:[t.jsx("h3",{children:i}),t.jsx("p",{children:"Total Student"})]})]})]})]})]}),t.jsxs("div",{className:s.rightPanel,children:[t.jsxs("h2",{children:["Attendance Records for ",new Date(r).toLocaleDateString()]}),c!=="all"&&t.jsxs("p",{children:["Subject: ",c]}),t.jsx("div",{className:s.attendanceTable,children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Student ID"}),t.jsx("th",{children:"Name"}),t.jsx("th",{children:"Subject"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Time"})]})}),t.jsx("tbody",{children:d.length>0?d.map(e=>t.jsxs("tr",{children:[t.jsx("td",{children:e.studentId}),t.jsx("td",{children:e.name}),t.jsx("td",{children:e.subject}),t.jsx("td",{children:t.jsx("span",{className:`${s.status} ${s[e.status]}`,children:e.status})}),t.jsx("td",{children:new Date(e.date).toLocaleTimeString()})]},e._id)):t.jsx("tr",{children:t.jsx("td",{colSpan:"5",className:s.noData,children:"No attendance records for this date"})})})]})})]})]})]})};export{ft as default};
